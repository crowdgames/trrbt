---
name: connect four
tree:
  type: order
  children:
  - type: set-board
    pattern: = = = = = = =;
             _ _ _ _ _ _ _;
             _ _ _ _ _ _ _;
             _ _ _ _ _ _ _;
             _ _ _ _ _ _ _;
             _ _ _ _ _ _ _;
             _ _ _ _ _ _ _;
  - type: loop-until-all
    nid: gameloop
    children:
    - type: x-ident
      nid: ply
      children:
      - type: player
        pid: R
        children:
        - type: rewrite
          lhs: =;_
          rhs: =;R
      - type: loop-until-all
        children:
        - type: rewrite
          lhs: R;_
          rhs: _;R
      - type: win
        pid: R
        children:
        - type: x-rotate
          children:
          - type: x-skew
            children:
            - type: match
              pattern: R R R R
    - type: x-set-player
      pid: Y
      children:
      - type: x-swap-only
        what: R
        with: Y
        children:
        - type: x-link
          target: ply
