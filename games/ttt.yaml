---
name: tic-tac-toe
tree:
  type: sequence
  children:
  - type: set-board
    pattern: _ _ _;
             _ _ _;
             _ _ _;
  - type: loop-until-all
    nid: gameloop
    children:
    - type: x-ident
      nid: move
      children:
      - type: player
        comment: player moves
        pid: X
        children:
        - type: rewrite
          lhs: _
          rhs: X
      - type: win
        comment: check for player win
        pid: X
        children:
        - type: x-turn
          children:
          - type: x-skew
            children:
            - type: match
              pattern: X X X
      - type: draw
        comment: check for draw
        children:
        - type: none
          children:
          - type: match
            pattern: _
    - type: x-set-player
      pid: O
      children:
      - type: x-swaponly
        what: X
        with: O
        children:
        - type: x-link
          target: move
