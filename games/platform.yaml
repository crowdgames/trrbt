---
name: platformer
start:
- _   _   _   _   _   _   _   _   _ ;
  _   _   _   _   _   _   _   _   _ ;
  _   _   _   _   _   _   Q   _   _ ;
  _   _   _   _   _   _   _   _   _ ;
  _   _   _   _   E   _   _   _   _ ;
  P0  _   _   _   X   X   X   _   O ;
  X   X   X   X   X   X   X   X   X ;
tree:
  type: replaceonly
  what: a
  with:
  - 0
  - 1
  - 2
  children:
  - type: sequence
    children:
    - type: player
      number: 1
      children:
      - type: rewrite
        lhs: Pa
        rhs: Pa
      - type: mirror
        children:
        - type: rewrite
          lhs: Pa  _
          rhs: _   Pa
        - type: rewrite
          lhs: Pa  O
          rhs: _   W
      - type: rewrite
        lhs: P0 ;X
        rhs: P2 ;X
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: _   E
        rhs: E'  _
      - type: rewrite
        lhs: Pa  E
        rhs: E'   _
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: E'
        rhs: E
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: E  ;_
        rhs: _  ;E'
      - type: rewrite
        lhs: P0 ;_
        rhs: _  ;P0'
      - type: rewrite
        lhs: P0 ;O
        rhs: _  ;W
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: E  ;Pa
        rhs: _  ;E'
      - type: rewrite
        lhs: P0 ;E
        rhs: _  ;P0'
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: _  ;P1
        rhs: P0';_
      - type: rewrite
        lhs: X  ;P1
        rhs: X  ;P0'
      - type: rewrite
        lhs: Q  ;P1
        rhs: X  ;P0'
      - type: rewrite
        lhs: _  ;P2
        rhs: P1';_
      - type: rewrite
        lhs: X  ;P1
        rhs: X  ;P0'
      - type: rewrite
        lhs: Q  ;P1
        rhs: X  ;P0'
    - type: loop-until-all
      children:
      - type: rewrite
        lhs: E'
        rhs: E
      - type: rewrite
        lhs: Pa'
        rhs: Pa
    - type: win
      number: 1
      children:
      - type: match
        pattern: W
    - type: lose
      number: 1
      children:
      - type: none
        children:
        - type: match
          pattern: Pa
