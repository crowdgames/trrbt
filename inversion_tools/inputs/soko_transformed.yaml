name: sokoban-gameloop
tree:
  type: loop-until-all
  nid: gameloop
  children:
  - type: player
    pid: "1"
    children:
    - type: rewrite
      button: right
      lhs: P _
      rhs: _ P
    - type: rewrite 
      button: left 
      lhs: _ P
      rhs: P _
    - type: rewrite
      button: down
      lhs: P; 
           _; 
      rhs: _;
           P;
    - type: rewrite
      button: up
      lhs: _; 
           P; 
      rhs: P;
           _;
    - type: rewrite
      button: right
      lhs: P O _
      rhs: _ P O
    - type: rewrite
      button: left
      lhs: _ O P;
      rhs: O P _;
    - type: rewrite
      button: up
      lhs: _;
           O;
           P; 
      rhs: O; 
           P; 
           _; 
    - type: rewrite
      button: down
      lhs: P; 
           O; 
           _; 
      rhs: _;
           P;
           O;
  - type: win
    pid: "1"
    children:
    - type: match-times
      times: 0
      pattern:
        main: O
        trgt: _
