{"name":"stephens_sausage_roll","sprites":null,"tree":{"type":"order","comment":"","nid":"","children":[{"type":"order","friendly":"do-all","comment":"set up","nid":"","children":[{"type":"set-board","comment":"","nid":"","pattern":{"main":[["#","#","#","#","#","#","#"],["#","#","_","_","_","#","#"],["#","#","s>","<s","sv","#","#"],["G","G","4","P","s^","G","#"],["G","G","#","#","#","G","G"]]}},{"type":"layer-template","comment":"","nid":"","layer":"push","with":"_"},{"type":"order","friendly":"do-all","comment":"set up player","nid":"","children":[{"type":"layer-template","comment":"","nid":"","layer":"player","with":"_"},{"type":"layer-template","comment":"","nid":"","layer":"coll-p","with":"_"},{"type":"x-spin","comment":"","friendly":"rotate-all","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"main":[["P","4"]]},"rhs":{"main":[["_","_"]],"player":[["P","4"]],"coll-p":[["P","P"]]}}],"remorig":false}]},{"type":"order","friendly":"do-all","comment":"set up sausages","nid":"","children":[{"type":"layer-template","comment":"","nid":"","layer":"sausage","with":"_"},{"type":"layer-template","comment":"","nid":"","layer":"coll-s","with":"_"},{"type":"layer-template","comment":"","nid":"","layer":"s-bottom","with":"_"},{"type":"layer-template","comment":"","nid":"","layer":"s-top","with":"_"},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"main":[["s>","<s"]]},"rhs":{"main":[["_","_"]],"sausage":[["s>","<s"]],"s-top":[["s","s"]],"s-bottom":[["s","s"]],"coll-s":[["S","S"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"main":[["sv"],["s^"]]},"rhs":{"main":[["_"],["_"]],"sausage":[["sv"],["s^"]],"s-top":[["s"],["s"]],"s-bottom":[["s"],["s"]],"coll-s":[["S"],["S"]]}}]}]},{"type":"loop-until-all","friendly":"loop-until-all-fail","comment":"","nid":"","children":[{"type":"player","friendly":"player-choice","comment":"","nid":"","children":[{"type":"x-spin","comment":"TODO: instead of rotate-all, copy for all directions and add a push arrow to all spaces that will be pushed if it's a sausage.","friendly":"rotate-all","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"right","lhs":{"player":[["P","4","_"]],"main":[["_","_","."]]},"rhs":{"player":[["_","P","4"]],"main":[["_","_","."]]}},{"type":"rewrite","comment":"","nid":"","button":"left","lhs":{"player":[["_","P","4"]],"main":[["_","_","."]]},"rhs":{"player":[["P","4","_"]],"main":[["_","_","."]]}},{"type":"rewrite","comment":"","nid":"","button":"down","lhs":{"main":[["P","4"],["_","_"]]},"rhs":{"main":[["P","_"],["4","_"]]}},{"type":"rewrite","comment":"","nid":"","button":"down","lhs":{"main":[["4","P"],["_","_"]]},"rhs":{"main":[["_","P"],["_","4"]]}}],"remorig":false}],"pid":""},{"type":"order","friendly":"do-all","comment":"push TODO: up and down pushes","nid":"","children":[{"type":"order","friendly":"do-all","comment":"setup","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-p":[["P","P"]],"coll-s":[["_","S"]],"push":[["_","_"]]},"rhs":{"coll-p":[["P","P"]],"coll-s":[["_","S"]],"push":[["_",">"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-p":[["P","P"]],"coll-s":[["S","_"]],"push":[["_","_"]]},"rhs":{"coll-p":[["P","P"]],"coll-s":[["S","_"]],"push":[["<","_"]]}}]},{"type":"loop-until-all","friendly":"loop-until-all-fail","comment":"rollout","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-s":[["S","S"]],"push":[[">","_"]]},"rhs":{"coll-s":[["S","S"]],"push":[[">",">"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-s":[["S","S"]],"push":[["_","<"]]},"rhs":{"coll-s":[["S","S"]],"push":[["<","<"]]}},{"type":"x-replace","comment":"","friendly":"replace-chars","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"sausage":[["sv"],["s^"]],"push":[["*"],["_"]]},"rhs":{"sausage":[["sv"],["s^"]],"push":[["*"],["*"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"sausage":[["sv"],["s^"]],"push":[["_"],["*"]]},"rhs":{"sausage":[["sv"],["s^"]],"push":[["*"],["*"]]}}],"what":"*","withs":[">","<"]}]},{"type":"order","friendly":"do-all","comment":"execute","nid":"","children":[{"type":"loop-until-all","friendly":"loop-until-all-fail","comment":"push layers","nid":"","children":[{"type":"x-replace","comment":"push sausage","friendly":"replace-chars","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"sausage":[["s*","_"]],"push":[[">","."]]},"rhs":{"sausage":[["_","s*"]],"push":[[">","."]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"sausage":[["_","s*"]],"push":[[".","<"]]},"rhs":{"sausage":[["s*","_"]],"push":[[".","<"]]}}],"what":"s*","withs":["s>","<s","s^","sv"]},{"type":"x-replace","comment":"push top/bottom","friendly":"replace-chars","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"s-top":[["$","_"]],"push":[[">","."]]},"rhs":{"s-top":[["_","$"]],"push":[[">","."]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"s-bottom":[["$","_"]],"push":[[">","."]]},"rhs":{"s-bottom":[["_","$"]],"push":[[">","."]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"s-top":[["_","$"]],"push":[[".","<"]]},"rhs":{"s-top":[["$","_"]],"push":[[".","<"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"s-bottom":[["_","$"]],"push":[[".","<"]]},"rhs":{"s-bottom":[["$","_"]],"push":[[".","<"]]}}],"what":"$","withs":["s","S","X"]}]},{"type":"loop-until-all","friendly":"loop-until-all-fail","comment":"push collision and unset","nid":"","children":[{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-s":[["S","_"]],"push":[[">","_"]]},"rhs":{"coll-s":[["_","S"]],"push":[["_","_"]]}},{"type":"rewrite","comment":"","nid":"","button":"","lhs":{"coll-s":[["_","S"]],"push":[["_","<"]]},"rhs":{"coll-s":[["S","_"]],"push":[["_","_"]]}}]}]}]}]}],"friendly":"do-all"}}